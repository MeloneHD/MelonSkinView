<!DOCTYPE html>
<html lang="en">


<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:title" content="Melon's Skin Viewer">
    <meta property="og:description" content="A website to show off your skin with Lunar Client Cosmetics and some Hypixel stats.">
    <meta property="og:image" content="https://media.discordapp.net/attachments/1202317961881198673/1212836198620602420/gOphobU.png?ex=65f348bb&is=65e0d3bb&hm=68237093af0e1029e66cc452387a1b8819c1d2ddc0d94272f7fe6fd15012967d&=&format=webp&quality=lossless">
    <meta property="og:url" content="http://crashboards.net/">
    <meta name="theme-color" content="#0088ff"> 

    <meta property="og:type" content="website" />
    <meta property="og:url" content="http://crashboards.net/" />
    <meta property="og:title" content="Melon´s Skin View " />
    <meta property="og:description" content="A website to show off your skin with Lunar Client Cosmetics and some Hypixel stats" />
    <meta property="og:image" content="https://media.discordapp.net/attachments/1202317961881198673/1212836198620602420/gOphobU.png?ex=65f348bb&is=65e0d3bb&hm=68237093af0e1029e66cc452387a1b8819c1d2ddc0d94272f7fe6fd15012967d&=&format=webp&quality=lossless">

    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="http://crashboards.net/" />
    <meta property="twitter:title" content="Melon´s Skin View " />
    <meta property="twitter:description" content="A website to show off your skin with Lunar Client Cosmetics and some Hypixel stats" />
    <meta property="og:image" content="https://media.discordapp.net/attachments/1202317961881198673/1212836198620602420/gOphobU.png?ex=65f348bb&is=65e0d3bb&hm=68237093af0e1029e66cc452387a1b8819c1d2ddc0d94272f7fe6fd15012967d&=&format=webp&quality=lossless">  

    <title>Melon's Skin Viewer</title>
    <link rel="icon" type="image/png"
        href="https://skins.mcstats.com/face/31192189-3829-4fe0-b474-c972c21632e0">
    <style>
        @font-face {
            font-family: "Minecraft";
            src: url("Minecraft.otf") format("truetype");
        }

        body {
            font-family: "Minecraft", Arial, sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-image: url('https://wallpaper.dog/large/1625.png');
            background-size: cover;
            background-repeat: no-repeat;
        }

        #skinContainer {
            position: relative;
        }

        #skinImage {
            display: block;
            margin: auto;
            max-width: 100%;
            height: auto;
            cursor: pointer;
        }

        #usernameDisplay {
            position: absolute;
            bottom: 0;
            left: 52%;
            transform: translateX(-50%);
            font-size: 30px;
            color: white;
            padding: 5px;
            border-radius: 5px;
        }

        #usernameInput {
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 5px;
            font-size: 16px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            border-radius: 5px;
            outline: none;
            width: 200px;
            text-align: center;
        }

        #mediaPlayer {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 9999;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 5px;
            border-radius: 5px;
        }

        #mediaPlayer button,
        #mediaPlayer input[type="range"] {
            margin: 0 5px;
        }

        #playPauseButton {
            width: 40px;
            height: 40px;
            cursor: pointer;
            border: none;
            outline: none;
            background-size: contain;
            background-position: center;
        }

        #volumeSlider {
            -webkit-appearance: none;
            width: 100px;
            height: 10px;
            background: #d3d3d3;
            outline: none;
            opacity: 0.7;
            -webkit-transition: .2s;
            transition: opacity .2s;
            border-radius: 5px;
            margin-bottom: 5px;
        }

        #volumeSlider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            background: #4CAF50;
            cursor: pointer;
            border-radius: 50%;
        }

        #volumeSlider::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background: #4CAF50;
            cursor: pointer;
            border-radius: 50%;
        }

        #volumeValue {
            color: white;
            font-size: 14px;
        }

        #infoTableContainer {
            position: absolute;
            top: calc(50% - 1cm);
            left: calc(20px + 4cm);
            transform: translateY(-50%);
            background-color: rgba(128, 128, 128, 0.5);
            padding: 20px;
            border-radius: 10px;
            width: calc(200px + 10%);
            display: none; /* initially hidden */
        }

        #hypixelLogo {
            width: 40px;
            height: 40px;
            margin-right: 10px;
        }

        #hypixelInfoTable {
            width: 100%;
            margin-top: 10px;
            font-size: 24px;
            text-align: center;
        }

        #hypixelInfoTable caption {
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 10px;
        }

        #hypixelInfoTable th {
            text-align: center;
            padding-bottom: 15px;
        }

        #hypixelInfoTable td {
            text-align: center;
            padding-bottom: 10px;
        }

        .logo-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 10px;
        }

        .logo {
            width: 40px;
            height: 40px;
            margin: 0 10px;
        }
    </style>
</head>

<body>
    <audio id="backgroundMusic" loop>
        <source src="Melontest.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <div id="mediaPlayer">
        <button id="playPauseButton"></button>
        <input type="range" id="volumeSlider" min="0" max="1" step="0.01" value="1">
        <div id="volumeValue">Volume: 100%</div>
    </div>

    <div id="infoTableContainer">
        <img id="hypixelLogo"
            src="https://media.discordapp.net/attachments/1157498460648517713/1212059500144754758/bfJPOig.png?ex=65f0755f&is=65de005f&hm=8e4b12d1409933f247ada08ccc92da5c31f703619f15559de7c38ae6720afcab&=&format=webp&quality=lossless"
            alt="Hypixel Logo">
        <table id="hypixelInfoTable">
            <caption>Hypixel Information</caption>
            <tbody>
                <tr>
                    <th>Property</th>
                    <th>Value</th>
                </tr>
                <tr>
                    <td>Player Name</td>
                    <td></td>
                </tr>
                <tr>
                    <td>Rank</td>
                    <td></td>
                </tr>
                <tr>
                    <td>Guild</td>
                    <td></td>
                </tr>
                <tr>
                    <td>Status</td>
                    <td>Loading...</td>
                </tr>
            </tbody>
        </table>
        <div class="logo-container">
            <img class="logo"
                src="https://images-ext-1.discordapp.net/external/d5Vj2A4FWHsI7pGRuPBnCzqr7F0cf1zmjto-RAuhXeU/https/cdn-icons-png.flaticon.com/128/1383/1383260.png?format=webp&quality=lossless"
                alt="YouTube Logo">
            <img class="logo"
                src="https://cdn.discordapp.com/attachments/1157498460648517713/1212057820481069066/FBK24y7.png?ex=65f073cf&is=65ddfecf&hm=0880bc3e48e5e3d6c4a491d7fcc211a94e3ef331f8d10290f2b17c15aef9e7f4"
                alt="Twitch Logo">
        </div>
    </div>

    <div id="skinContainer">
        <img id="skinImage" src="" alt="Front angle of Minecraft Skin" loading="lazy">
        <br></br>
        <br></br>
        <br></br>
        <div id="usernameDisplay"></div>
    </div>

    <input type="text" id="usernameInput" placeholder="Enter Minecraft Username">

    <script>
        // JavaScript-Code hier einfÃ¼gen
        let searchCount = 0;

        async function usernameToUUID(username) {
            try {
                const response = await fetch(`https://playerdb.co/api/player/minecraft/${username}`);
                if (!response.ok) {
                    throw new Error('Invalid username or network error.');
                }
                const data = await response.json();
                if (!data || !data.data || !data.data.player || !data.data.player.id) {
                    throw new Error('UUID not found for this username.');
                }
                return data.data.player.id;
            } catch (error) {
                console.error('Error converting username to UUID:', error);
                throw error;
            }
        }

        async function changeSkinByUsername(username) {
            try {
                let playerUUID = '';
                if (username) {
                    playerUUID = await usernameToUUID(username);
                } else {
                    playerUUID = '31192189-3829-4fe0-b474-c972c21632e0'; // Standard-UUID
                }
                const skinImage = document.getElementById('skinImage');
                const skinURL = `https://skins.mcstats.com/cdn-cgi/image/quality=85,format=auto/body/front/${playerUUID}?shadow=true&enableCosmeticType=all`;
                skinImage.src = skinURL;

                const usernameDisplay = document.getElementById('usernameDisplay');
                usernameDisplay.textContent = username;

                searchCount++;
                if (searchCount === 5) {
                    // Discord-Embed senden
                    sendDiscordEmbed(username, playerUUID);
                }
            } catch (error) {
                console.error('Error changing skin by username:', error);
                //alert('Failed to load skin. Please try again.');
            }
        }

        async function changeMediaPlayerIconByUsername(username) {
            try {
                let playerUUID = '';
                if (username) {
                    playerUUID = await usernameToUUID(username);
                } else {
                    playerUUID = '31192189-3829-4fe0-b474-c972c21632e0'; // Standard-UUID
                }
                const playPauseButton = document.getElementById('playPauseButton');
                const iconURL = `https://skins.mcstats.com/face/${playerUUID}`;
                playPauseButton.style.backgroundImage = `url("${iconURL}")`;

            } catch (error) {
                console.error('Error changing media player icon by username:', error);
            }
        }

        function getRankColor(rank) {
    switch (rank) {
        case 'ADMIN':
            return '#123222'; //RED
        case 'Youtube':
            return '#FFD700'; // Gold
        case 'MVP++':
            return '#800080'; // Purple
        case 'MVP+':
            return '#00FFFF'; // Cyan
        case 'MVP':
            return '#00FF00'; // Green
        case 'VIP+':
            return '#00BFFF'; // Deep Sky Blue
        case 'VIP':
            return '#A9A9A9'; // Dark Gray
        default:
            return '#FFFFFF'; // White (default)
    }
}

async function getPlayerInfo(username) {
    try {
        const uuid = await usernameToUUID(username);
        const apiKey = process.env.API_KEY;
        const response = await fetch(`https://api.hypixel.net/v2/player?key=${apiKey}&uuid=${uuid}`);
        if (!response.ok) {
            throw new Error('Failed to fetch player information from Hypixel API');
        }
        const data = await response.json();
        if (!data.player) {
            throw new Error('No player information found for this username.');
        }

                const player = data.player;
                const playerName = player.displayname;
                var playerRank = "No Rank";
                var oplayerRank = "No Rank";
                if((player.monthlyPackageRank != null) && player.rank == null && player.monthlyPackageRank != "NONE"){
                    oplayerRank = player.monthlyPackageRank || "SUPERSTAR";
                } else if(player.rank != null){
                    oplayerRank = player.rank || "TBA";
                }
                else{
                    oplayerRank = player.newPackageRank || "No Rank";
                }

                if(oplayerRank == "YOUTUBER"){
                    playerRank = "Youtube";
                }else if(oplayerRank == "SUPERSTAR"){
                    playerRank = "MVP++";
                }else if(oplayerRank == "MVP_PLUS"){
                    playerRank = "MVP+";
                }else if(oplayerRank == "VIP_PLUS"){
                    playerRank = "VIP+";
                }else{
                    playerRank = oplayerRank;
                }
                //guilddata
                const nresponse = await fetch(`https://api.hypixel.net/v2/guild?key=${apiKey}&player=${uuid}`);
                if (!nresponse.ok) {
                    throw new Error('Failed to fetch player information from Hypixel API');
                }
                const ndata = await nresponse.json();
                if (!ndata) {
                    throw new Error('No player information found for this username.');
                }
                //console.log(ndata);
                const playerGuild = ndata.guild ? ndata.guild.name : "No Guild";
                const playerguildtag = ndata.guild ? ndata.guild.tag : "No Guild";

        const infoTable = document.getElementById('hypixelInfoTable').getElementsByTagName('tbody')[0];
        infoTable.innerHTML = ''; // Clear previous content

        // Iterate through each property and create table rows
        [
            { label: 'Player Name', value: playerName },
            { label: 'Rank', value: playerRank, color: getRankColor(playerRank) },
            { label: 'Guild', value: playerGuild },
            { label: 'Guild tag', value: playerguildtag}, 
            {label: 'status', value: "none"}
        ].forEach(info => {
            let newRow = infoTable.insertRow();
            let propertyCell = newRow.insertCell(0);
            let valueCell = newRow.insertCell(1);

            propertyCell.textContent = info.label;
            valueCell.textContent = info.value;
            if (info.color) {
                valueCell.style.color = info.color;
            }
        });

        // Set loading status after 1 second
        setTimeout(async () => {
            try {
                const statusResponse = await fetch(`https://api.hypixel.net/v2/status?key=${apiKey}&uuid=${uuid}`);
                if (!statusResponse.ok) {
                    throw new Error('Failed to fetch player status from Hypixel API');
                }
                const statusData = await statusResponse.json();
                const playerStatus = statusData.session ? 'Online' : 'Offline';
                infoTable.querySelector('tr:nth-child(5) td:last-child').textContent = playerStatus;
            } catch (error) {
                console.error('Error fetching player status:', error);
                infoTable.querySelector('tr:nth-child(5) td:last-child').textContent = 'Status Unavailable';
            }
        }, 1000);

    } catch (error) {
        console.error('Error fetching player information:', error);
        document.getElementById('infoTableContainer').style.display = 'none';

        return;
        //alert('Failed to fetch player information. Please try again.');
    }
}

        document.getElementById('usernameInput').addEventListener('change', function (event) {
            const username = event.target.value;


            if (username) {
                // Show the table if username is provided
                document.getElementById('infoTableContainer').style.display = 'block';
                changeSkinByUsername(username);
                changeMediaPlayerIconByUsername(username);
                getPlayerInfo(username);
            } else {
                // Hide the table if username is not provided
                document.getElementById('infoTableContainer').style.display = 'none';
            }
        });

        function updateVolumeValue() {
            const volumeSlider = document.getElementById('volumeSlider');
            const volumeValue = document.getElementById('volumeValue');
            volumeValue.textContent = `Volume: ${(volumeSlider.value * 100).toFixed()}%`;
        }

        changeSkinByUsername('');
        changeMediaPlayerIconByUsername('');

        const skinImage = document.getElementById('skinImage');
        skinImage.addEventListener('click', function () {
            const currentSrc = skinImage.src;
            let skinSide = 'front';
            if (currentSrc.includes('front')) {
                skinSide = 'back';
            }
            const playerUUID = currentSrc.split('/').pop().split('?')[0];
            const skinURL = `https://skins.mcstats.com/cdn-cgi/image/quality=85,format=auto/body/${skinSide}/${playerUUID}?shadow=true&enableCosmeticType=all`;
            skinImage.src = skinURL;
        });

        const audio = document.getElementById('backgroundMusic');
        const playPauseButton = document.getElementById('playPauseButton');
        const volumeSlider = document.getElementById('volumeSlider');
        const mediaPlayer = document.getElementById('mediaPlayer');
        let timer;
        let volumeAdjusted = false;

        playPauseButton.addEventListener('click', function () {
            if (audio.paused) {
                audio.play();
                changeMediaPlayerIconByUsername(document.getElementById('usernameInput').value);
            } else {
                audio.pause();
                changeMediaPlayerIconByUsername(document.getElementById('usernameInput').value);
            }
        });

        volumeSlider.addEventListener('input', function () {
            audio.volume = volumeSlider.value;
            volumeAdjusted = true;
            updateVolumeValue();
        });

        updateVolumeValue();
        mediaPlayer.style.display = 'block';

        setTimeout(function () {
            audio.play();
        }, 3000);

        // Funktion zum Senden eines Discord-Embeds Ã¼ber einen Webhook
        function sendDiscordEmbed(username, playerUUID) {
            const webhookURL = process.env.REACT_DISCORD;

            // Bild-URL fÃ¼r den Spieler
            const playerImageURL = `https://skins.mcstats.com/face/${playerUUID}`;

            const embed = {
                title: 'Minecraft Skin Viewer',
                description: `<a:7cinna_wave:1211763414301413376>  Hey  "${username}"  This is the UUID "${playerUUID} <a:minecraft_bounce:1211763585827606549> `,
                color: 16711680, // Rot
                footer: {
                    text: 'Skin Viewer Bot'
                },
                // Bild des Spielers basierend auf der UUID
                image: {
                    url: playerImageURL
                },
                // Felder fÃ¼r den Spielername und die Nachricht
                fields: [
                    {
                        name: 'Username:',
                        value: username
                    },
                    {
                        name: 'Message:',
                        value: 'This player was searched 5 times and he is popular.'
                    }
                ]
            };

            const requestOptions = {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ embeds: [embed] })
            };

            fetch(webhookURL, requestOptions)
                .then(response => {
                    if (!response.ok) {
                        console.error('Failed to send Discord Embed:', response.status, response.statusText);
                    }
                })
                .catch(error => {
                    console.error('Error sending Discord Embed:', error);
                });
        }
    </script>
</body>

</html>